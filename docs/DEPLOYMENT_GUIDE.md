# é¹¤å±±ç§¯åˆ†ç®¡ç†ç³»ç»Ÿ - éƒ¨ç½²æŒ‡å—

> æœ¬æ–‡æ¡£é€‚åˆé›¶åŸºç¡€ç”¨æˆ·é˜…è¯»ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰è¯¦ç»†è¯´æ˜ã€‚

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
2. [æœ¬åœ°å¼€å‘](#æœ¬åœ°å¼€å‘)
3. [Zeabur äº‘éƒ¨ç½²ï¼ˆæ¨èï¼‰](#zeabur-äº‘éƒ¨ç½²æ¨è)
4. [Docker éƒ¨ç½²](#docker-éƒ¨ç½²)
5. [ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²](#ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é¡¹ç›®ç®€ä»‹

### ç³»ç»Ÿæ¶æ„

```
ç”¨æˆ·æµè§ˆå™¨
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Zeabur / äº‘æœåŠ¡å™¨            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     Node.js æœåŠ¡å™¨            â”‚  â”‚
â”‚  â”‚  â€¢ æä¾›ç½‘é¡µæ–‡ä»¶ (å‰ç«¯)         â”‚  â”‚
â”‚  â”‚  â€¢ æä¾›æ•°æ®æ¥å£ (åç«¯ API)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PostgreSQL æ•°æ®åº“               â”‚
â”‚     (Supabase æˆ– è‡ªå»º)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| å‰ç«¯ | React + Vite | ç”¨æˆ·ç•Œé¢ |
| åç«¯ | Node.js + Express | API æœåŠ¡ |
| æ•°æ®åº“ | PostgreSQL | æ•°æ®å­˜å‚¨ |

---

## æœ¬åœ°å¼€å‘

> é€‚åˆå¼€å‘è€…åœ¨è‡ªå·±ç”µè„‘ä¸Šè¿è¡Œå’Œä¿®æ”¹ä»£ç ã€‚

### ç¬¬ä¸€æ­¥ï¼šå®‰è£… Node.js

1. è®¿é—® https://nodejs.org/
2. ä¸‹è½½ **LTS ç‰ˆæœ¬**ï¼ˆæ¨è 22.xï¼‰
3. åŒå‡»å®‰è£…ï¼Œä¸€è·¯ç‚¹"ä¸‹ä¸€æ­¥"
4. å®‰è£…å®Œæˆåï¼Œæ‰“å¼€å‘½ä»¤è¡ŒéªŒè¯ï¼š
   ```bash
   node --version
   # åº”æ˜¾ç¤º v22.x.x
   ```

### ç¬¬äºŒæ­¥ï¼šä¸‹è½½ä»£ç 

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ Git
git clone https://github.com/ä½ çš„ç”¨æˆ·å/hrjf.git

# æ–¹å¼2ï¼šç›´æ¥ä¸‹è½½ ZIP å¹¶è§£å‹
```

### ç¬¬ä¸‰æ­¥ï¼šå®‰è£…ä¾èµ–

æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š

```bash
cd hrjf
npm install
```

> ğŸ’¡ **ä»€ä¹ˆæ˜¯ä¾èµ–ï¼Ÿ** å°±æ˜¯é¡¹ç›®è¿è¡Œéœ€è¦çš„ç¬¬ä¸‰æ–¹åº“ï¼Œç±»ä¼¼äºæ‰‹æœº App éœ€è¦çš„æ’ä»¶ã€‚

### ç¬¬å››æ­¥ï¼šé…ç½®æ•°æ®åº“è¿æ¥

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env.server` æ–‡ä»¶ï¼š

```env
DATABASE_URL=postgresql://ç”¨æˆ·å:å¯†ç @æœåŠ¡å™¨åœ°å€:5432/æ•°æ®åº“å
PORT=3000
```

> âš ï¸ **é‡è¦**ï¼šè¿™ä¸ªæ–‡ä»¶åŒ…å«å¯†ç ï¼Œ**ä¸è¦ä¸Šä¼ åˆ° Git**ï¼

### ç¬¬äº”æ­¥ï¼šå¯åŠ¨

```bash
npm start
```

ç„¶åæ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5173

---

## Zeabur äº‘éƒ¨ç½²ï¼ˆæ¨èï¼‰

> **Zeabur** æ˜¯ä¸€ä¸ªäº‘å¹³å°ï¼Œå¯ä»¥è‡ªåŠ¨éƒ¨ç½²ä½ çš„åº”ç”¨ï¼Œæ— éœ€è‡ªå·±ç®¡ç†æœåŠ¡å™¨ã€‚
> 
> âš ï¸ **é‡è¦æç¤º**ï¼šZeabur ç›®å‰åªæ”¯æŒä» **GitHub** å¯¼å…¥ä»£ç ï¼Œä¸æ”¯æŒ Giteeï¼

### å‡†å¤‡å·¥ä½œ

1. æ³¨å†Œ [GitHub è´¦å·](https://github.com)
2. å°†ä»£ç æ¨é€åˆ° GitHubï¼ˆè§ä¸‹æ–¹è¯´æ˜ï¼‰
3. æ³¨å†Œ [Zeabur è´¦å·](https://zeabur.com)

### æ­¥éª¤ 1ï¼šå°†ä»£ç æ¨é€åˆ° GitHub

å¦‚æœä½ çš„ä»£ç åœ¨ Gitee ä¸Šï¼Œéœ€è¦å…ˆåŒæ­¥åˆ° GitHubï¼š

```bash
# æ·»åŠ  GitHub è¿œç¨‹ä»“åº“
git remote add github https://github.com/ä½ çš„ç”¨æˆ·å/hrjf.git

# æ¨é€åˆ° GitHub
git push github main
```

### æ­¥éª¤ 2ï¼šåœ¨ Zeabur åˆ›å»ºé¡¹ç›®

1. ç™»å½• [Zeabur æ§åˆ¶å°](https://dash.zeabur.com)
2. ç‚¹å‡» **Create Project**ï¼ˆåˆ›å»ºé¡¹ç›®ï¼‰
3. é€‰æ‹©ä¸€ä¸ªåŒºåŸŸï¼ˆæ¨èé€‰æ‹©ç¦»ä½ è¿‘çš„ï¼‰

![åˆ›å»ºé¡¹ç›®](https://docs.zeabur.com/assets/images/create-project-xxx.png)

### æ­¥éª¤ 3ï¼šæ·»åŠ æœåŠ¡

1. åœ¨é¡¹ç›®ä¸­ç‚¹å‡» **Add Service**ï¼ˆæ·»åŠ æœåŠ¡ï¼‰
2. é€‰æ‹© **Git**
3. é€‰æ‹©ä½ çš„ GitHub ä»“åº“

Zeabur ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° `Dockerfile`ï¼Œå¼€å§‹æ„å»ºéƒ¨ç½²ã€‚

### æ­¥éª¤ 4ï¼šé…ç½®ç¯å¢ƒå˜é‡ â­é‡è¦

> è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼æ•°æ®åº“è¿æ¥ä¿¡æ¯éœ€è¦åœ¨è¿™é‡Œé…ç½®ã€‚

1. ç‚¹å‡»ä½ çš„æœåŠ¡
2. è¿›å…¥ **Variables**ï¼ˆå˜é‡ï¼‰æ ‡ç­¾
3. ç‚¹å‡» **Add Variable**ï¼ˆæ·»åŠ å˜é‡ï¼‰
4. æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

| å˜é‡å | å€¼ | è¯´æ˜ |
|--------|-----|------|
| `DATABASE_URL` | `postgresql://ç”¨æˆ·å:å¯†ç @ä¸»æœº:5432/æ•°æ®åº“å` | **å¿…å¡«**ï¼Œæ•°æ®åº“è¿æ¥åœ°å€ |

**å¦‚ä½•è·å– DATABASE_URLï¼Ÿ**

å¦‚æœä½ ä½¿ç”¨ Supabaseï¼š
1. ç™»å½• [Supabase](https://supabase.com)
2. è¿›å…¥é¡¹ç›® â†’ Settings â†’ Database
3. å¤åˆ¶ Connection String (Session Pooler)
4. å°† `[YOUR-PASSWORD]` æ›¿æ¢ä¸ºä½ çš„æ•°æ®åº“å¯†ç 

ç¤ºä¾‹ï¼š
```
postgresql://postgres.abc123:MyPassword@aws-0-us-east-1.pooler.supabase.com:5432/postgres
```

### æ­¥éª¤ 5ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆ

- æ„å»ºé€šå¸¸éœ€è¦ 2-5 åˆ†é’Ÿ
- çŠ¶æ€å˜ä¸º **Running** è¡¨ç¤ºéƒ¨ç½²æˆåŠŸ

### æ­¥éª¤ 6ï¼šç»‘å®šåŸŸå

1. è¿›å…¥ **Networking**ï¼ˆç½‘ç»œï¼‰æ ‡ç­¾
2. ç‚¹å‡» **Generate Domain**ï¼ˆç”ŸæˆåŸŸåï¼‰
3. ä½ ä¼šè·å¾—ä¸€ä¸ªç±»ä¼¼ `xxx.zeabur.app` çš„åŸŸå
4. æˆ–è€…ç»‘å®šä½ è‡ªå·±çš„åŸŸå

### éªŒè¯éƒ¨ç½²

è®¿é—®ä½ çš„åŸŸåï¼Œä¾‹å¦‚ï¼š
```
https://ä½ çš„åº”ç”¨.zeabur.app
```

æ£€æŸ¥ API æ˜¯å¦æ­£å¸¸ï¼š
```
https://ä½ çš„åº”ç”¨.zeabur.app/api/health
```

åº”è¯¥è¿”å›ï¼š
```json
{"connected":true,"ok":1}
```

---

## Docker éƒ¨ç½²

> é€‚åˆæœ‰è‡ªå·±æœåŠ¡å™¨çš„ç”¨æˆ·ã€‚

### æ­¥éª¤ 1ï¼šå®‰è£… Docker

- Windows/Mac: ä¸‹è½½ [Docker Desktop](https://www.docker.com/products/docker-desktop)
- Linux: 
  ```bash
  curl -fsSL https://get.docker.com | sh
  ```

### æ­¥éª¤ 2ï¼šæ„å»ºé•œåƒ

åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
docker build -t heshan-hr:latest .
```

> ğŸ’¡ è¿™ä¼šæ ¹æ® `Dockerfile` åˆ›å»ºä¸€ä¸ªåº”ç”¨é•œåƒï¼Œå¤§çº¦éœ€è¦ 3-5 åˆ†é’Ÿã€‚

### æ­¥éª¤ 3ï¼šè¿è¡Œå®¹å™¨

```bash
docker run -d \
  --name heshan-hr \
  -p 8080:8080 \
  -e DATABASE_URL="postgresql://ç”¨æˆ·å:å¯†ç @ä¸»æœº:5432/æ•°æ®åº“å" \
  heshan-hr:latest
```

**å‚æ•°è¯´æ˜**ï¼š
- `-d`ï¼šåå°è¿è¡Œ
- `--name heshan-hr`ï¼šå®¹å™¨åç§°
- `-p 8080:8080`ï¼šç«¯å£æ˜ å°„ï¼ˆè®¿é—®æœåŠ¡å™¨çš„ 8080 ç«¯å£ï¼‰
- `-e DATABASE_URL="..."`ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆ**å¿…é¡»å¡«å†™ä½ çš„æ•°æ®åº“åœ°å€**ï¼‰

### æ­¥éª¤ 4ï¼šè®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://æœåŠ¡å™¨IP:8080

---

## ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²

> é€‚åˆä½¿ç”¨ä¼ ç»Ÿäº‘æœåŠ¡å™¨ï¼ˆå¦‚é˜¿é‡Œäº‘ ECSã€è…¾è®¯äº‘ç­‰ï¼‰çš„ç”¨æˆ·ã€‚

### æ­¥éª¤ 1ï¼šè¿æ¥æœåŠ¡å™¨

ä½¿ç”¨ SSH è¿æ¥ä½ çš„æœåŠ¡å™¨ï¼š

```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

### æ­¥éª¤ 2ï¼šå®‰è£… Node.js

```bash
# å®‰è£… Node.js 22
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt install -y nodejs
```

### æ­¥éª¤ 3ï¼šä¸Šä¼ ä»£ç 

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
git clone https://github.com/ä½ çš„ç”¨æˆ·å/hrjf.git /var/www/heshan-hr
cd /var/www/heshan-hr
```

### æ­¥éª¤ 4ï¼šå®‰è£…ä¾èµ–å¹¶æ„å»º

```bash
npm install
npm run build
```

### æ­¥éª¤ 5ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cat > .env.server << EOF
DATABASE_URL=postgresql://ç”¨æˆ·å:å¯†ç @ä¸»æœº:5432/æ•°æ®åº“å
PORT=8080
NODE_ENV=production
EOF
```

### æ­¥éª¤ 6ï¼šä½¿ç”¨ PM2 ç®¡ç†è¿›ç¨‹

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start server.js --name heshan-hr

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

### æ­¥éª¤ 7ï¼šé…ç½® Nginxï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨ 80 ç«¯å£æˆ–é…ç½® HTTPSï¼š

```bash
sudo apt install nginx
```

åˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/nginx/sites-available/heshan-hr`ï¼š

```nginx
server {
    listen 80;
    server_name ä½ çš„åŸŸå.com;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

å¯ç”¨é…ç½®ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/heshan-hr /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

---

## å¸¸è§é—®é¢˜

### Q1ï¼šéƒ¨ç½²åæ— æ³•è®¿é—®

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ… ç¯å¢ƒå˜é‡ `DATABASE_URL` æ˜¯å¦æ­£ç¡®é…ç½®ï¼Ÿ
2. âœ… æ•°æ®åº“æ˜¯å¦å…è®¸å¤–éƒ¨è¿æ¥ï¼Ÿ
3. âœ… é˜²ç«å¢™æ˜¯å¦å¼€æ”¾äº†å¯¹åº”ç«¯å£ï¼Ÿ

### Q2ï¼šAPI è¿”å› 500 é”™è¯¯

è¿™é€šå¸¸æ˜¯æ•°æ®åº“è¿æ¥é—®é¢˜ï¼š

```bash
# æ£€æŸ¥æ—¥å¿—
# Zeabur: åœ¨æ§åˆ¶é¢æ¿çš„ Logs æ ‡ç­¾æŸ¥çœ‹
# Docker: docker logs heshan-hr
# PM2: pm2 logs heshan-hr
```

### Q3ï¼šå‰ç«¯é¡µé¢æ˜¾ç¤ºç©ºç™½

å¯èƒ½æ˜¯æ„å»ºå¤±è´¥ï¼Œæ£€æŸ¥ `dist` ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚

### Q4ï¼šå¦‚ä½•æ›´æ–°éƒ¨ç½²ï¼Ÿ

**Zeabur**ï¼šæ¨é€ä»£ç åˆ° GitHubï¼Œè‡ªåŠ¨é‡æ–°éƒ¨ç½²

**Docker**ï¼š
```bash
docker stop heshan-hr
docker rm heshan-hr
docker build -t heshan-hr:latest .
docker run -d --name heshan-hr -p 8080:8080 -e DATABASE_URL="..." heshan-hr:latest
```

**PM2**ï¼š
```bash
git pull
npm run build
pm2 restart heshan-hr
```

---

## ç›¸å…³èµ„æº

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [æ•°æ®åº“è¿ç§»æŒ‡å—](./database/migration/MIGRATION_GUIDE.md) | ä» Supabase è¿ç§»åˆ°å…¶ä»–æ•°æ®åº“ |
| [æ›´æ–°æ—¥å¿—](./docs/CHANGELOG.md) | ç‰ˆæœ¬æ›´æ–°è®°å½• |

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. é”™è¯¯æˆªå›¾æˆ–æ—¥å¿—
2. ä½¿ç”¨çš„éƒ¨ç½²æ–¹å¼
3. æ“ä½œç³»ç»Ÿç‰ˆæœ¬

---

*æ–‡æ¡£ç‰ˆæœ¬: 2.0*  
*æ›´æ–°æ—¥æœŸ: 2025-12-11*
